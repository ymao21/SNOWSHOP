{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{csrfFetch}from'./csrf';var SET_USER='session/setUser';var REMOVE_USER='session/removeUser';var setUser=function setUser(user){return{type:SET_USER,payload:user};};var removeUser=function removeUser(){return{type:REMOVE_USER};};export var login=function login(user){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var credential,password,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:credential=user.credential,password=user.password;console.log(\"user\",user);_context.next=4;return csrfFetch('/api/session',{method:'POST',body:JSON.stringify({credential:credential,password:password})});case 4:response=_context.sent;_context.next=7;return response.json();case 7:data=_context.sent;dispatch(setUser(data));return _context.abrupt(\"return\",response);case 10:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var restoreUser=function restoreUser(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return csrfFetch('/api/session');case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:data=_context2.sent;dispatch(setUser(data));return _context2.abrupt(\"return\",response);case 8:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var signup=function signup(user){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var username,email,password,firstName,lastName,response,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:username=user.username,email=user.email,password=user.password,firstName=user.firstName,lastName=user.lastName;_context3.next=3;return csrfFetch(\"/api/users\",{method:\"POST\",body:JSON.stringify({username:username,email:email,password:password,firstName:firstName,lastName:lastName})});case 3:response=_context3.sent;if(!response.ok){_context3.next=10;break;}_context3.next=7;return response.json();case 7:data=_context3.sent;dispatch(setUser(data));return _context3.abrupt(\"return\",data);case 10:return _context3.abrupt(\"return\",response);case 11:case\"end\":return _context3.stop();}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return csrfFetch('/api/session',{method:'DELETE'});case 2:response=_context4.sent;dispatch(removeUser());return _context4.abrupt(\"return\",response);case 5:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};var initialState={user:{}};var sessionReducer=function sessionReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;var newState;switch(action.type){case SET_USER:newState=Object.assign({},state);newState.user=action.payload;return newState;case REMOVE_USER:newState=Object.assign({},state);newState.user={};return newState;default:return state;}};export default sessionReducer;","map":{"version":3,"names":["csrfFetch","SET_USER","REMOVE_USER","setUser","user","type","payload","removeUser","login","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","credential","password","response","data","wrap","_callee$","_context","prev","next","console","log","method","body","JSON","stringify","sent","json","abrupt","stop","_x","apply","arguments","restoreUser","_ref2","_callee2","_callee2$","_context2","_x2","signup","_ref3","_callee3","username","email","firstName","lastName","_callee3$","_context3","ok","_x3","logout","_ref4","_callee4","_callee4$","_context4","_x4","initialState","sessionReducer","state","length","undefined","action","newState","Object","assign"],"sources":["/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/src/store/session.js"],"sourcesContent":["import { csrfFetch } from './csrf';\n\nconst SET_USER = 'session/setUser';\nconst REMOVE_USER = 'session/removeUser';\n\nconst setUser = (user) => {\n  return {\n    type: SET_USER,\n    payload: user,\n  };\n};\n\nconst removeUser = () => {\n  return {\n    type: REMOVE_USER,\n  };\n};\n\nexport const login = (user) => async (dispatch) => {\n  const { credential, password } = user;\n\n  console.log(\"user\", user)\n\n  const response = await csrfFetch('/api/session', {\n    method: 'POST',\n    body: JSON.stringify({\n      credential,\n      password,\n    }),\n  });\n\n\n  const data = await response.json();\n  dispatch(setUser(data));\n  return response;\n};\n\nexport const restoreUser = () => async dispatch => {\n    const response = await csrfFetch('/api/session');\n    const data = await response.json();\n    dispatch(setUser(data));\n    return response;\n  };\n\n  export const signup = (user) => async (dispatch) => {\n    const { username, email, password, firstName, lastName } = user;\n    const response = await csrfFetch(\"/api/users\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        username,\n        email,\n        password,\n        firstName,\n        lastName\n      }),\n    });\n\n   if(response.ok) {\n    const data = await response.json();\n    dispatch(setUser(data));\n    return data;\n   }\n   return response\n\n  };\n\n  export const logout = () => async (dispatch) => {\n    const response = await csrfFetch('/api/session', {\n      method: 'DELETE',\n    });\n    dispatch(removeUser());\n    return response;\n  };\n\n  const initialState = { user: {} };\n\n  const sessionReducer = (state = initialState, action) => {\n    let newState;\n    switch (action.type) {\n      case SET_USER:\n        newState = Object.assign({}, state);\n        newState.user = action.payload;\n        return newState;\n\n      case REMOVE_USER:\n        newState = Object.assign({}, state);\n        newState.user = {};\n        return newState;\n        \n      default:\n        return state;\n    }\n  };\n\nexport default sessionReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}