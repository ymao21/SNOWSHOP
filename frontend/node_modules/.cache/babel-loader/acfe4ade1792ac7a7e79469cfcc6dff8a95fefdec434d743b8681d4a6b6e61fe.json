{"ast":null,"code":"import { csrfFetch } from \"./csrf\";\nconst LOAD_CART = '/cart/LOAD_CART';\nconst ADD_ITEM = 'cart/addItem';\nconst REMOVE_CART = '/cart/REMOVE_CART';\nconst EDIT_QUANTITY = '/cart/EDIT_QUANTITY';\nconst CLEAR_CART = '/cart/CLEAR_CART';\n\n// Action creators\nexport const loadToCart = products => {\n  return {\n    type: LOAD_CART,\n    products\n  };\n};\nexport const addToCart = (itemId, count) => ({\n  type: ADD_ITEM,\n  itemId,\n  count\n});\nexport const editQuantity = (cartItemId, newQuantity) => {\n  return {\n    type: EDIT_QUANTITY,\n    cartItemId,\n    newQuantity\n  };\n};\nexport const deleteFromCart = productId => {\n  return {\n    type: REMOVE_CART,\n    productId\n  };\n};\nexport const clearCart = () => {\n  return {\n    type: CLEAR_CART\n  };\n};\nexport const loadAllCartThunk = () => async dispatch => {\n  const response = await csrfFetch('/api/cart');\n  if (response.ok) {\n    const cartItems = await response.json();\n    dispatch(loadToCart(cartItems));\n    return cartItems;\n  }\n  return response;\n};\nexport const deleteCartThunk = productId => async dispatch => {\n  const response = await csrfFetch(`/api/cart/${productId}`, {\n    method: 'DELETE'\n  });\n  if (response.ok) {\n    const removeFromCart = await response.json();\n    dispatch(deleteFromCart(removeFromCart));\n    return removeFromCart;\n  }\n  return response;\n};\nexport const addToCartThunk = product => (dispatch, getState) => {\n  const {\n    cart\n  } = getState();\n  const itemId = product.id;\n\n  // Check if the item is already in the cart\n  if (cart.items[itemId]) {\n    // Increment the count if it exists\n    const updatedCount = cart.items[itemId].count + 1;\n    dispatch(addToCart(itemId, updatedCount));\n  } else {\n    // Add a new item with count 1\n    dispatch(addToCart(itemId, 1));\n  }\n  const newCartData = {\n    ...cart,\n    items: {\n      ...cart.items,\n      [itemId]: {\n        id: itemId,\n        count: cart.items[itemId] ? cart.items[itemId].count + 1 : 1\n      }\n    },\n    order: cart.order.includes(itemId) ? cart.order : [...cart.order, itemId]\n  };\n  localStorage.setItem('cartData', JSON.stringify(newCartData));\n};\nconst initialState = {\n  items: {},\n  order: []\n};\nconst cartReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case LOAD_CART:\n      return {\n        ...state,\n        cartItems: action.products\n      };\n    case ADD_ITEM:\n      const newStateAdd = {\n        ...state,\n        items: {\n          ...state.items,\n          [action.itemId]: {\n            id: action.itemId,\n            count: action.count\n          }\n        },\n        order: [...state.order, action.itemId]\n      };\n      localStorage.setItem('cartData', JSON.stringify(newStateAdd));\n      return newStateAdd;\n    case EDIT_QUANTITY:\n      return {\n        ...state,\n        cartItems: state.cartItems.map(item => item.id === action.cartItemId ? {\n          ...item,\n          quantity: action.newQuantity\n        } : item)\n      };\n    case REMOVE_CART:\n      return {\n        ...state,\n        cartItems: state.cartItems.filter(item => item.id !== action.productId)\n      };\n    case CLEAR_CART:\n      return {\n        ...state,\n        cartItems: []\n      };\n    default:\n      return state;\n  }\n};\nexport default cartReducer;","map":{"version":3,"names":["csrfFetch","LOAD_CART","ADD_ITEM","REMOVE_CART","EDIT_QUANTITY","CLEAR_CART","loadToCart","products","type","addToCart","itemId","count","editQuantity","cartItemId","newQuantity","deleteFromCart","productId","clearCart","loadAllCartThunk","dispatch","response","ok","cartItems","json","deleteCartThunk","method","removeFromCart","addToCartThunk","product","getState","cart","id","items","updatedCount","newCartData","order","includes","localStorage","setItem","JSON","stringify","initialState","cartReducer","state","arguments","length","undefined","action","newStateAdd","map","item","quantity","filter"],"sources":["/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/src/store/cart.js"],"sourcesContent":["import { csrfFetch } from \"./csrf\";\n\nconst LOAD_CART = '/cart/LOAD_CART';\nconst ADD_ITEM = 'cart/addItem';\nconst REMOVE_CART = '/cart/REMOVE_CART';\nconst EDIT_QUANTITY = '/cart/EDIT_QUANTITY';\nconst CLEAR_CART = '/cart/CLEAR_CART';\n\n// Action creators\nexport const loadToCart = (products) => {\n  return {\n    type: LOAD_CART,\n    products,\n  };\n};\n\nexport const addToCart = (itemId, count) => ({\n  type: ADD_ITEM,\n  itemId,\n  count,\n});\n\nexport const editQuantity = (cartItemId, newQuantity) => {\n  return {\n    type: EDIT_QUANTITY,\n    cartItemId,\n    newQuantity,\n  };\n};\n\nexport const deleteFromCart = (productId) => {\n  return {\n    type: REMOVE_CART,\n    productId,\n  };\n};\n\nexport const clearCart = () => {\n  return {\n    type: CLEAR_CART,\n  };\n};\n\nexport const loadAllCartThunk = () => async (dispatch) => {\n  const response = await csrfFetch('/api/cart');\n\n  if (response.ok) {\n    const cartItems = await response.json();\n    dispatch(loadToCart(cartItems));\n    return cartItems;\n  }\n  return response;\n};\n\nexport const deleteCartThunk = (productId) => async (dispatch) => {\n  const response = await csrfFetch(`/api/cart/${productId}`, {\n      method: 'DELETE'\n  })\n  if(response.ok) {\n      const removeFromCart = await response.json()\n      dispatch(deleteFromCart(removeFromCart))\n      return removeFromCart\n  }\n\n  return response;\n}\n\nexport const addToCartThunk = (product) => (dispatch, getState) => {\n  const { cart } = getState();\n  const itemId = product.id;\n\n  // Check if the item is already in the cart\n  if (cart.items[itemId]) {\n    // Increment the count if it exists\n    const updatedCount = cart.items[itemId].count + 1;\n    dispatch(addToCart(itemId, updatedCount));\n  } else {\n    // Add a new item with count 1\n    dispatch(addToCart(itemId, 1));\n  }\n  const newCartData = {\n    ...cart,\n    items: {\n      ...cart.items,\n      [itemId]: {\n        id: itemId,\n        count: cart.items[itemId] ? cart.items[itemId].count + 1 : 1,\n      },\n    },\n    order: cart.order.includes(itemId) ? cart.order : [...cart.order, itemId],\n  };\n\n  localStorage.setItem('cartData', JSON.stringify(newCartData));\n};\n\n\n\nconst initialState = {\n  items: {},\n  order: [],\n};\n\nconst cartReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case LOAD_CART:\n      return {\n        ...state,\n        cartItems: action.products,\n      };\n\n      case ADD_ITEM:\n        const newStateAdd = {\n          ...state,\n          items: {\n            ...state.items,\n            [action.itemId]: {\n              id: action.itemId,\n              count: action.count,\n            },\n          },\n          order: [...state.order, action.itemId],\n        };\n        localStorage.setItem('cartData', JSON.stringify(newStateAdd));\n        return newStateAdd;\n\n\n    case EDIT_QUANTITY:\n      return {\n        ...state,\n        cartItems: state.cartItems.map((item) =>\n          item.id === action.cartItemId ? { ...item, quantity: action.newQuantity } : item\n        ),\n      };\n    case REMOVE_CART:\n      return {\n        ...state,\n        cartItems: state.cartItems.filter((item) => item.id !== action.productId),\n      };\n    case CLEAR_CART:\n      return {\n        ...state,\n        cartItems: [],\n      };\n    default:\n      return state;\n  }\n};\n\nexport default cartReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}