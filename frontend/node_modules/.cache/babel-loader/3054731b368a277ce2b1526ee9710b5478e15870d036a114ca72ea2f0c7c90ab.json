{"ast":null,"code":"import { csrfFetch } from \"./csrf\";\nconst LOAD_CART = '/cart/LOAD_CART';\nconst ADD_CART = '/cart/ADD_CART';\nconst REMOVE_CART = '/cart/REMOVE_CART';\nconst EDIT_QUANTITY = '/cart/EDIT_QUANTITY';\n\n// Action creators\nexport const loadToCart = (products, cartId) => {\n  return {\n    type: LOAD_CART,\n    products,\n    cartId\n  };\n};\nexport const addToCart = product => {\n  return {\n    type: ADD_CART,\n    product\n  };\n};\nexport const editQuantity = (cartItemId, newQuantity) => {\n  return {\n    type: EDIT_QUANTITY,\n    cartItemId,\n    newQuantity\n  };\n};\nexport const deleteFromCart = (cartId, productId) => {\n  return {\n    type: REMOVE_CART,\n    productId,\n    cartId\n  };\n};\nexport const loadAllCartThunk = _ref => {\n  let {\n    cartId\n  } = _ref;\n  return async dispatch => {\n    const response = await csrfFetch(`/api/cart/${cartId}`);\n    if (response.ok) {\n      const cartItems = await response.json();\n      dispatch(loadToCart(cartId, cartItems));\n      return cartItems;\n    }\n    return response;\n  };\n};\nexport const addToCartThunk = _ref2 => {\n  let {\n    cartId,\n    productId\n  } = _ref2;\n  return async dispatch => {\n    const response = await csrfFetch(`/api/cart/${cartId}`, {\n      method: 'POST',\n      body: JSON.stringify({\n        productId,\n        cartId\n      })\n    });\n    if (response.ok) {\n      const product = await response.json();\n      dispatch(addToCart(product));\n      return product;\n    }\n    return response;\n  };\n};\nexport const editQuantityThunk = (cartItemId, newQuantity, productId, cartId) => async dispatch => {\n  const response = await csrfFetch(`/api/cart/${cartId}`, {\n    method: 'PUT',\n    body: JSON.stringify({\n      cartItemId,\n      newQuantity,\n      productId,\n      cartId\n    })\n  });\n  if (response.ok) {\n    const product = await response.json();\n    console.log(product);\n    dispatch(editQuantity(cartItemId, product.quantity));\n    return product;\n  }\n};\nexport const deleteCartThunk = (cartId, productId) => async dispatch => {\n  const response = await csrfFetch(`/api/cart/${cartId}/${productId}`, {\n    method: 'DELETE'\n  });\n  if (response.ok) {\n    const removeFromCart = await response.json();\n    dispatch(deleteFromCart(cartId, productId));\n    return removeFromCart;\n  }\n};\nconst initialState = {\n  cartItems: {\n    CartProduct: {}\n  },\n  cartId: null\n};\nconst cartReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case LOAD_CART:\n      const normalizedCartItems = action.products.Products.reduce((acc, item) => {\n        acc[item.CartProduct.id] = item;\n        return acc;\n      }, {});\n      return {\n        ...state,\n        cartItems: normalizedCartItems,\n        cartId: action.cartId\n      };\n    case ADD_CART:\n      return {\n        ...state,\n        cartItems: {\n          ...state.cartItems,\n          [action.product.productId]: action.product\n        }\n      };\n    case EDIT_QUANTITY:\n      const newState = {\n        ...state\n      };\n      newState.cartItems[action.cartItemId].CartProduct.quantity = action.newQuantity;\n      return newState;\n    case REMOVE_CART:\n      const {\n        [action.productId]: _,\n        ...updatedCartItems\n      } = state.cartItems;\n      return {\n        ...state,\n        cartItems: updatedCartItems\n      };\n    default:\n      return state;\n  }\n};\nexport default cartReducer;","map":{"version":3,"names":["csrfFetch","LOAD_CART","ADD_CART","REMOVE_CART","EDIT_QUANTITY","loadToCart","products","cartId","type","addToCart","product","editQuantity","cartItemId","newQuantity","deleteFromCart","productId","loadAllCartThunk","_ref","dispatch","response","ok","cartItems","json","addToCartThunk","_ref2","method","body","JSON","stringify","editQuantityThunk","console","log","quantity","deleteCartThunk","removeFromCart","initialState","CartProduct","cartReducer","state","arguments","length","undefined","action","normalizedCartItems","Products","reduce","acc","item","id","newState","_","updatedCartItems"],"sources":["/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/src/store/cart.js"],"sourcesContent":["import { csrfFetch } from \"./csrf\";\n\nconst LOAD_CART = '/cart/LOAD_CART';\nconst ADD_CART = '/cart/ADD_CART';\nconst REMOVE_CART = '/cart/REMOVE_CART';\nconst EDIT_QUANTITY = '/cart/EDIT_QUANTITY';\n\n// Action creators\nexport const loadToCart = (products, cartId) => {\n  return {\n    type: LOAD_CART,\n    products,\n    cartId\n  };\n};\n\nexport const addToCart = (product) => {\n  return {\n    type: ADD_CART,\n    product,\n  };\n};\n\nexport const editQuantity = (cartItemId, newQuantity) => {\n  return {\n    type: EDIT_QUANTITY,\n    cartItemId,\n    newQuantity,\n  };\n};\n\nexport const deleteFromCart = (cartId, productId) => {\n  return {\n    type: REMOVE_CART,\n    productId,\n    cartId\n  };\n};\n\n\nexport const loadAllCartThunk = ({cartId}) => async (dispatch) => {\n  const response = await csrfFetch(`/api/cart/${cartId}`);\n\n  if (response.ok) {\n    const cartItems = await response.json();\n    dispatch(loadToCart(cartId, cartItems));\n    return cartItems;\n  }\n  return response;\n};\n\nexport const addToCartThunk = ({cartId, productId}) => async (dispatch) => {\n\n const response = await csrfFetch(`/api/cart/${cartId}`, {\n  method: 'POST',\n  body: JSON.stringify({productId, cartId})\n });\n\n  if (response.ok) {\n    const product = await response.json();\n    dispatch(addToCart(product));\n    return product;\n  }\n\n  return response;\n};\n\nexport const editQuantityThunk = (cartItemId, newQuantity, productId, cartId) => async (dispatch) => {\n\n  const response = await csrfFetch(`/api/cart/${cartId}`, {\n    method: 'PUT',\n    body: JSON.stringify({cartItemId, newQuantity, productId, cartId})\n   });\n\nif (response.ok) {\n\n  const product = await response.json()\n  console.log(product)\n  dispatch(editQuantity(cartItemId, product.quantity ))\n  return product\n\n}\n}\n\nexport const deleteCartThunk = (cartId, productId) => async (dispatch) => {\n  const response = await csrfFetch(`/api/cart/${cartId}/${productId}`, {\n      method: 'DELETE'\n  })\n\n  if(response.ok) {\n    const removeFromCart = await response.json()\n    dispatch(deleteFromCart(cartId, productId))\n    return removeFromCart\n  }\n}\n\nconst initialState = {\n  cartItems: {CartProduct: {}},\n  cartId: null\n};\n\nconst cartReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case LOAD_CART:\n\n      const normalizedCartItems = action.products.Products.reduce(\n        (acc, item) => {\n          acc[item.CartProduct.id] = item;\n          return acc;\n        },\n        {}\n      );\n      return {\n        ...state,\n        cartItems: normalizedCartItems,\n        cartId: action.cartId\n      };\n    case ADD_CART:\n      return {\n        ...state,\n        cartItems: {\n          ...state.cartItems,\n          [action.product.productId]: action.product,\n        },\n      };\n    case EDIT_QUANTITY:\n      const newState = {...state}\n      newState.cartItems[action.cartItemId].CartProduct.quantity = action.newQuantity\n      return newState\n    case REMOVE_CART:\n      const { [action.productId]: _, ...updatedCartItems } = state.cartItems;\n      return {\n        ...state,\n        cartItems: updatedCartItems,\n      };\n    default:\n      return state;\n  }\n};\n\n\nexport default cartReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}