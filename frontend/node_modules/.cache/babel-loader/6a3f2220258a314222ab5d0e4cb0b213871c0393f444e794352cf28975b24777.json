{"ast":null,"code":"import _objectSpread from\"/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{csrfFetch}from\"./csrf\";var LOAD_PRODUCTS='products/loadProducts';var CREATE_PRODUCT='products/createProduct';var EDIT_PRODUCT='products/editProduct';var DELETE_PRODUCT='products/deleteProduct';export var loadProducts=function loadProducts(products){return{type:LOAD_PRODUCTS,products:products};};export var addOneProduct=function addOneProduct(product){return{type:CREATE_PRODUCT,product:product};};export var editProduct=function editProduct(product){return{type:EDIT_PRODUCT,product:product};};export var deleteProduct=function deleteProduct(productId){return{type:DELETE_PRODUCT,productId:productId};};export var getProductsThunk=function getProductsThunk(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response,products;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return csrfFetch('/api/products');case 2:response=_context.sent;if(!response.ok){_context.next=8;break;}_context.next=6;return response.json();case 6:products=_context.sent;return _context.abrupt(\"return\",dispatch(loadProducts(products.product)));case 8:return _context.abrupt(\"return\",response);case 9:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var getProductDetailThunk=function getProductDetailThunk(productId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var response,product;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return csrfFetch(\"/api/products/\".concat(productId));case 2:response=_context2.sent;if(!response.ok){_context2.next=8;break;}_context2.next=6;return response.json();case 6:product=_context2.sent;return _context2.abrupt(\"return\",dispatch(addOneProduct(product)));case 8:return _context2.abrupt(\"return\",response);case 9:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var createProductThunk=function createProductThunk(payload){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var response,newProduct;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return csrfFetch(\"/api/products/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(payload)});case 2:response=_context3.sent;if(!response.ok){_context3.next=9;break;}_context3.next=6;return response.json();case 6:newProduct=_context3.sent;dispatch(addOneProduct(newProduct));return _context3.abrupt(\"return\",newProduct);case 9:return _context3.abrupt(\"return\",response);case 10:case\"end\":return _context3.stop();}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var editProductThunk=function editProductThunk(payload){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var response,product;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return csrfFetch(\"/api/products/\".concat(payload.productId),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(payload)});case 2:response=_context4.sent;if(!response.ok){_context4.next=9;break;}_context4.next=6;return response.json();case 6:product=_context4.sent;dispatch(editProduct(product));return _context4.abrupt(\"return\",product);case 9:return _context4.abrupt(\"return\",response);case 10:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var deleteProductThunk=function deleteProductThunk(productId){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(dispatch){var response,deletedProduct;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return csrfFetch(\"/api/products/\".concat(productId),{method:'DELETE'});case 2:response=_context5.sent;if(!response.ok){_context5.next=9;break;}_context5.next=6;return response.json();case 6:deletedProduct=_context5.sent;dispatch(deleteProduct(productId));return _context5.abrupt(\"return\",deletedProduct);case 9:return _context5.abrupt(\"return\",response);case 10:case\"end\":return _context5.stop();}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}();};var initialState={};var productsReducer=function productsReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;var newState=_objectSpread({},state);switch(action.type){case LOAD_PRODUCTS:action.products.forEach(function(product){newState[product.id]=product;});return newState;case CREATE_PRODUCT:newState=_objectSpread({},state);newState[action.id]=action.product;return newState;case DELETE_PRODUCT:newState=_objectSpread({},state);delete newState[action.productId];return newState;default:return state;}};export default productsReducer;","map":{"version":3,"names":["csrfFetch","LOAD_PRODUCTS","CREATE_PRODUCT","EDIT_PRODUCT","DELETE_PRODUCT","loadProducts","products","type","addOneProduct","product","editProduct","deleteProduct","productId","getProductsThunk","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","response","wrap","_callee$","_context","prev","next","sent","ok","json","abrupt","stop","_x","apply","arguments","getProductDetailThunk","_ref2","_callee2","_callee2$","_context2","concat","_x2","createProductThunk","payload","_ref3","_callee3","newProduct","_callee3$","_context3","method","headers","body","JSON","stringify","_x3","editProductThunk","_ref4","_callee4","_callee4$","_context4","_x4","deleteProductThunk","_ref5","_callee5","deletedProduct","_callee5$","_context5","_x5","initialState","productsReducer","state","length","undefined","action","newState","_objectSpread","forEach","id"],"sources":["/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/src/store/products.js"],"sourcesContent":["import { csrfFetch } from \"./csrf\";\n\nconst LOAD_PRODUCTS = 'products/loadProducts'\nconst CREATE_PRODUCT = 'products/createProduct'\nconst EDIT_PRODUCT ='products/editProduct'\nconst DELETE_PRODUCT = 'products/deleteProduct'\n\nexport const loadProducts = (products) => {\n    return {\n        type: LOAD_PRODUCTS,\n        products\n    }\n}\n\nexport const addOneProduct = (product) => {\n    return {\n        type: CREATE_PRODUCT,\n        product\n    }\n}\n\nexport const editProduct = (product) => {\n    return {\n        type: EDIT_PRODUCT,\n        product\n    }\n}\n\nexport const deleteProduct = (productId) => {\n    return {\n        type: DELETE_PRODUCT,\n        productId\n    }\n}\n\nexport const getProductsThunk = () => async (dispatch) => {\n    const response = await csrfFetch('/api/products');\n\n    if(response.ok) {\n        const products = await response.json();\n        return dispatch(loadProducts(products.product))\n    }\n    return response\n}\n\nexport const getProductDetailThunk = (productId) => async (dispatch) => {\n    const response = await csrfFetch(`/api/products/${productId}`);\n\n    if(response.ok) {\n        const product = await response.json();\n\n        return dispatch(addOneProduct(product))\n    }\n    return response\n}\n\nexport const createProductThunk = (payload) => async (dispatch) => {\n    const response = await csrfFetch(`/api/products/`,{\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload)\n});\n    if(response.ok) {\n        const newProduct = await response.json();\n        dispatch(addOneProduct(newProduct));\n        return newProduct\n    }\n    return response\n}\n\nexport const editProductThunk = (payload) => async (dispatch) => {\n    const response = await csrfFetch(`/api/products/${payload.productId}`,{\n    method: \"PUT\",\n\theaders: { \"Content-Type\": \"application/json\" },\n\tbody: JSON.stringify(payload)\n});\n    if(response.ok) {\n        const product = await response.json();\n        dispatch(editProduct(product));\n        return product\n    }\n    return response\n}\n\nexport const deleteProductThunk = (productId) => async (dispatch) => {\n    const response = await csrfFetch(`/api/products/${productId}`, {\n        method: 'DELETE'\n    })\n\n    if(response.ok) {\n        const deletedProduct = await response.json()\n        dispatch(deleteProduct(productId))\n        return deletedProduct\n    }\n    return response\n}\n\nconst initialState = {};\n\nconst productsReducer = (state = initialState, action) => {\n    let newState = {...state};\n    switch(action.type){\n        case LOAD_PRODUCTS:\n            action.products.forEach((product) => {\n                newState[product.id] = product\n            });\n            return newState\n\n        case CREATE_PRODUCT:\n            newState = {...state}\n            newState[action.id] = action.product\n            return newState\n\n        case DELETE_PRODUCT:\n            newState = {...state}\n            delete newState[action.productId]\n            return newState\n\n        default:\n            return state;\n\n    }\n}\n\nexport default productsReducer\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}