{"ast":null,"code":"import { csrfFetch } from './csrf';\nconst SET_USER = 'session/setUser';\nconst REMOVE_USER = 'session/removeUser';\nconst setUser = user => {\n  return {\n    type: SET_USER,\n    payload: user\n  };\n};\nconst removeUser = () => {\n  return {\n    type: REMOVE_USER\n  };\n};\nexport const login = user => async dispatch => {\n  const {\n    credential,\n    password\n  } = user;\n  const response = await csrfFetch('/api/session', {\n    method: 'POST',\n    body: JSON.stringify({\n      credential,\n      password\n    })\n  });\n  const data = await response.json();\n  dispatch(setUser(data));\n  return response;\n};\nexport const restoreUser = () => async dispatch => {\n  const response = await csrfFetch('/api/session');\n  const data = await response.json();\n  dispatch(setUser(data));\n  return response;\n};\nexport const signup = user => async dispatch => {\n  const {\n    username,\n    email,\n    password,\n    firstName,\n    lastName,\n    about\n  } = user;\n  const response = await csrfFetch(\"/api/users\", {\n    method: \"POST\",\n    body: JSON.stringify({\n      username,\n      email,\n      password,\n      firstName,\n      lastName,\n      about\n    })\n  });\n  if (response.ok) {\n    const data = await response.json();\n    dispatch(setUser(data));\n    return data;\n  }\n  return response;\n};\nexport const logout = () => async dispatch => {\n  const response = await csrfFetch('/api/session', {\n    method: 'DELETE'\n  });\n  dispatch(removeUser());\n  return response;\n};\nconst initialState = {\n  user: {}\n};\nconst sessionReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  let newState;\n  switch (action.type) {\n    case SET_USER:\n      newState = Object.assign({}, state);\n      newState.user = action.payload;\n      return newState;\n    case REMOVE_USER:\n      newState = Object.assign({}, state);\n      newState.user = {};\n      return newState;\n    default:\n      return state;\n  }\n};\nexport default sessionReducer;","map":{"version":3,"names":["csrfFetch","SET_USER","REMOVE_USER","setUser","user","type","payload","removeUser","login","dispatch","credential","password","response","method","body","JSON","stringify","data","json","restoreUser","signup","username","email","firstName","lastName","about","ok","logout","initialState","sessionReducer","state","arguments","length","undefined","action","newState","Object","assign"],"sources":["/Users/yiningmao/Desktop/SNOWSHOP Project/SNOWSHOP/frontend/src/store/session.js"],"sourcesContent":["import { csrfFetch } from './csrf';\n\nconst SET_USER = 'session/setUser';\nconst REMOVE_USER = 'session/removeUser';\n\nconst setUser = (user) => {\n  return {\n    type: SET_USER,\n    payload: user,\n  };\n};\n\nconst removeUser = () => {\n  return {\n    type: REMOVE_USER,\n  };\n};\n\nexport const login = (user) => async (dispatch) => {\n  const { credential, password } = user;\n\n\n  const response = await csrfFetch('/api/session', {\n    method: 'POST',\n    body: JSON.stringify({\n      credential,\n      password,\n    }),\n  });\n\n\n  const data = await response.json();\n  dispatch(setUser(data));\n  return response;\n};\n\nexport const restoreUser = () => async dispatch => {\n    const response = await csrfFetch('/api/session');\n    const data = await response.json();\n    dispatch(setUser(data));\n    return response;\n  };\n\n  export const signup = (user) => async (dispatch) => {\n    const { username, email, password, firstName, lastName, about } = user;\n    const response = await csrfFetch(\"/api/users\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        username,\n        email,\n        password,\n        firstName,\n        lastName,\n        about\n      }),\n    });\n\n   if(response.ok) {\n    const data = await response.json();\n    dispatch(setUser(data));\n    return data;\n   }\n   return response\n\n  };\n\n  export const logout = () => async (dispatch) => {\n    const response = await csrfFetch('/api/session', {\n      method: 'DELETE',\n    });\n    dispatch(removeUser());\n    return response;\n  };\n\n  const initialState = { user: {} };\n\n  const sessionReducer = (state = initialState, action) => {\n    let newState;\n    switch (action.type) {\n      case SET_USER:\n        newState = Object.assign({}, state);\n        newState.user = action.payload;\n        return newState;\n\n      case REMOVE_USER:\n        newState = Object.assign({}, state);\n        newState.user = {};\n        return newState;\n\n      default:\n        return state;\n    }\n  };\n\nexport default sessionReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}